# ä¸‰ä¸ªç‰ˆæœ¬çš„å¯¹æ¯”è¯´æ˜

## ğŸ“‹ ç‰ˆæœ¬æ€»è§ˆ

| æ–‡ä»¶å | è¿è¡Œæ–¹å¼ | è®°å¿†åŠŸèƒ½ | é€‚ç”¨åœºæ™¯ |
|--------|----------|----------|----------|
| `app.py` | ä¸€æ¬¡æ€§è¿è¡Œ | âŒ æ— è®°å¿† | å¿«é€Ÿæµ‹è¯•ã€æ¼”ç¤º |
| `app_first.py` | ç¬¬ä¸€æ¬¡è¿è¡Œ | âœ… ä¿å­˜è®°å¿† | å¼€å§‹æ–°å¯¹è¯ |
| `app_second.py` | ç¬¬äºŒæ¬¡è¿è¡Œ | âœ… åŠ è½½è®°å¿† | ç»§ç»­å¯¹è¯ |

---

## ğŸ” è¯¦ç»†å¯¹æ¯”

### 1ï¸âƒ£ app.py (åŸç‰ˆ - æ— è®°å¿†)

**ç‰¹ç‚¹:**
- ä¸€æ¬¡æ€§å®Œæˆä¸¤è½®å¯¹è¯
- å¯¹è¯ç»“æŸåè®°å¿†æ¶ˆå¤±
- é€‚åˆå¿«é€Ÿæµ‹è¯•

**ä»£ç ç»“æ„:**
```python
# åˆ›å»ºå¯¹è¯
chat = client.chats.create(model="gemini-2.5-flash")

# ç¬¬ä¸€è½®
response = chat.send_message("I have 2 dogs in my house.")

# ç¬¬äºŒè½®  
response = chat.send_message("How many paws are in my house?")

# æ˜¾ç¤ºå†å²
for message in chat.get_history():
    print(message)
```

**è¿è¡Œæ–¹å¼:**
```bash
python app.py
```

**è¾“å‡º:**
```
That's great! Dogs make wonderful companions...
With 2 dogs in your house, you have 8 paws!...
[æ˜¾ç¤ºå®Œæ•´å¯¹è¯å†å²]
```

**ä¼˜ç‚¹:**
- âœ… ç®€å•ç›´æ¥
- âœ… æ— éœ€é¢å¤–æ–‡ä»¶
- âœ… é€‚åˆå¿«é€Ÿæµ‹è¯•

**ç¼ºç‚¹:**
- âŒ ç¨‹åºç»“æŸåè®°å¿†æ¶ˆå¤±
- âŒ æ— æ³•åˆ†æ¬¡è¿è¡Œ
- âŒ æ— æ³•ä¿å­˜å¯¹è¯å†å²

---

### 2ï¸âƒ£ app_first.py (ç¬¬ä¸€æ¬¡è¿è¡Œ - ä¿å­˜è®°å¿†)

**ç‰¹ç‚¹:**
- å¼€å§‹æ–°å¯¹è¯
- ä¿å­˜å¯¹è¯å†å²åˆ°æ–‡ä»¶
- ä¸ºç¬¬äºŒæ¬¡è¿è¡Œåšå‡†å¤‡

**ä»£ç ç»“æ„:**
```python
# åˆ›å»ºå¯¹è¯
chat = client.chats.create(model="gemini-2.5-flash")

# å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯
response = chat.send_message("I have 2 dogs in my house.")

# è·å–å†å²
history = chat.get_history()

# ğŸ’¾ ä¿å­˜åˆ°æ–‡ä»¶
history_data = []
for message in history:
    message_dict = {
        "role": message.role,
        "content": message.parts[0].text
    }
    history_data.append(message_dict)

with open("chat_history.json", "w") as f:
    json.dump(history_data, f, ensure_ascii=False, indent=2)
```

**è¿è¡Œæ–¹å¼:**
```bash
python app_first.py
```

**è¾“å‡º:**
```
=== ç¬¬ä¸€æ¬¡è¿è¡Œ ===
å‘é€æ¶ˆæ¯: I have 2 dogs in my house.
AIå›å¤: That's great! Dogs make wonderful companions...

ä¿å­˜è®°å¿† - user: I have 2 dogs in my house.
ä¿å­˜è®°å¿† - model: That's great! Dogs make wonderful companions...

âœ… å¯¹è¯å†å²å·²ä¿å­˜åˆ° chat_history.json
ç°åœ¨å¯ä»¥è¿è¡Œ app_second.py ç»§ç»­å¯¹è¯
```

**ç”Ÿæˆçš„æ–‡ä»¶:** `chat_history.json`
```json
[
  {
    "role": "user",
    "content": "I have 2 dogs in my house."
  },
  {
    "role": "model", 
    "content": "That's great! Dogs make wonderful companions..."
  }
]
```

**ä¼˜ç‚¹:**
- âœ… ä¿å­˜å¯¹è¯å†å²
- âœ… å¯ä»¥ç¨åç»§ç»­
- âœ… è®°å¿†æŒä¹…åŒ–

**ç¼ºç‚¹:**
- âŒ éœ€è¦ä¸¤æ­¥æ“ä½œ
- âŒ ç”Ÿæˆé¢å¤–æ–‡ä»¶

---

### 3ï¸âƒ£ app_second.py (ç¬¬äºŒæ¬¡è¿è¡Œ - åŠ è½½è®°å¿†)

**ç‰¹ç‚¹:**
- åŠ è½½ä¹‹å‰ä¿å­˜çš„è®°å¿†
- æ¢å¤å¯¹è¯ä¸Šä¸‹æ–‡
- ç»§ç»­å¯¹è¯

**ä»£ç ç»“æ„:**
```python
# ğŸ“‚ åŠ è½½å†å²è®°å½•
with open("chat_history.json", "r") as f:
    history_data = json.load(f)

# åˆ›å»ºæ–°å¯¹è¯
chat = client.chats.create(model="gemini-2.5-flash")

# ğŸ”„ æ¢å¤å¯¹è¯ä¸Šä¸‹æ–‡
for msg in history_data:
    if msg["role"] == "user":
        chat.send_message(msg["content"])

# ğŸ’¬ ç»§ç»­å¯¹è¯
response = chat.send_message("How many paws are in my house?")

# ğŸ’¾ æ›´æ–°å†å²è®°å½•
# ... ä¿å­˜æ›´æ–°åçš„å†å² ...
```

**è¿è¡Œæ–¹å¼:**
```bash
python app_second.py
```

**è¾“å‡º:**
```
=== ç¬¬äºŒæ¬¡è¿è¡Œ ===
æ­£åœ¨åŠ è½½å¯¹è¯è®°å¿†...
âœ… æˆåŠŸåŠ è½½ 2 æ¡å†å²è®°å½•

æ­£åœ¨æ¢å¤å¯¹è¯ä¸Šä¸‹æ–‡...
å·²æ¢å¤è®°å¿† 1: I have 2 dogs in my house.

=== ç»§ç»­å¯¹è¯ ===
å‘é€æ¶ˆæ¯: How many paws are in my house?
AIå›å¤: With 2 dogs in your house, you have 8 paws!

=== å®Œæ•´å¯¹è¯å†å² ===
user: I have 2 dogs in my house.
model: That's great! Dogs make wonderful companions...
user: How many paws are in my house?
model: With 2 dogs in your house, you have 8 paws!
```

**ä¼˜ç‚¹:**
- âœ… å®Œæ•´è®°å¿†æ¢å¤
- âœ… AIè®°ä½ä¹‹å‰çš„å¯¹è¯
- âœ… å¯ä»¥å¤šæ¬¡ç»§ç»­

**ç¼ºç‚¹:**
- âŒ å¿…é¡»å…ˆè¿è¡Œ app_first.py
- âŒ ä¾èµ–å†å²æ–‡ä»¶

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯é€‰æ‹©

### åœºæ™¯ä¸€: å¿«é€Ÿæµ‹è¯•åŠŸèƒ½
```bash
python app.py
```
**åŸå› :** ä¸€æ¬¡æ€§å®Œæˆ,æ— éœ€ç®¡ç†æ–‡ä»¶

### åœºæ™¯äºŒ: éœ€è¦åˆ†æ¬¡è¿è¡Œ
```bash
python app_first.py   # ä»Šå¤©è¿è¡Œ
# ... è¿‡ä¸€æ®µæ—¶é—´ ...
python app_second.py  # æ˜å¤©è¿è¡Œ
```
**åŸå› :** ä¿æŒå¯¹è¯è¿ç»­æ€§

### åœºæ™¯ä¸‰: é•¿æœŸå¯¹è¯è®°å½•
```bash
python app_first.py   # ç¬¬1æ¬¡
python app_second.py  # ç¬¬2æ¬¡
python app_third.py   # ç¬¬3æ¬¡(éœ€è¦è‡ªå·±åˆ›å»º)
```
**åŸå› :** ç§¯ç´¯é•¿æœŸè®°å¿†

---

## ğŸ’¡ æ ¸å¿ƒæŠ€æœ¯åŸç†

### è®°å¿†ä¿å­˜åŸç†
```python
# 1. è·å–å¯¹è¯å†å²
history = chat.get_history()

# 2. æå–å…³é”®ä¿¡æ¯
for message in history:
    role = message.role        # "user" æˆ– "model"
    content = message.parts[0].text  # æ¶ˆæ¯å†…å®¹

# 3. ä¿å­˜ä¸ºJSON
json.dump(data, file)
```

### è®°å¿†æ¢å¤åŸç†
```python
# 1. è¯»å–JSONæ–‡ä»¶
data = json.load(file)

# 2. é‡æ–°å‘é€ç”¨æˆ·æ¶ˆæ¯
for msg in data:
    if msg["role"] == "user":
        chat.send_message(msg["content"])
        # AIä¼šè‡ªåŠ¨ç”Ÿæˆä¹‹å‰çš„å›å¤,ä»è€Œæ¢å¤ä¸Šä¸‹æ–‡
```

---

## ğŸ“Š æ€§èƒ½å¯¹æ¯”

| ç‰¹æ€§ | app.py | app_first.py + app_second.py |
|------|--------|------------------------------|
| è¿è¡Œé€Ÿåº¦ | å¿« | ä¸­ç­‰(éœ€è¦æ¢å¤ä¸Šä¸‹æ–‡) |
| å†…å­˜å ç”¨ | ä½ | ä¸­ç­‰(éœ€è¦ä¿å­˜å†å²) |
| æ–‡ä»¶ä¾èµ– | æ—  | 1ä¸ªJSONæ–‡ä»¶ |
| çµæ´»æ€§ | ä½ | é«˜ |
| è®°å¿†æŒä¹…æ€§ | æ—  | æ°¸ä¹… |

---

## ğŸ“ å­¦ä¹ å»ºè®®

### ç¬¬ä¸€æ­¥: ç†è§£åŸç‰ˆ
å…ˆè¿è¡Œ `app.py`,ç†è§£åŸºæœ¬çš„å¯¹è¯æµç¨‹

### ç¬¬äºŒæ­¥: ä½“éªŒè®°å¿†åŠŸèƒ½
ä¾æ¬¡è¿è¡Œ `app_first.py` å’Œ `app_second.py`,è§‚å¯ŸAIå¦‚ä½•è®°ä½å¯¹è¯

### ç¬¬ä¸‰æ­¥: æŸ¥çœ‹è®°å¿†å†…å®¹
æ‰“å¼€ `chat_history.json`,ç†è§£è®°å¿†çš„å­˜å‚¨æ ¼å¼

### ç¬¬å››æ­¥: æ‰©å±•åº”ç”¨
å°è¯•ä¿®æ”¹ä»£ç ,å®ç°æ›´å¤šè½®çš„å¯¹è¯

---

## ğŸ”§ å®é™…åº”ç”¨

è¿™ä¸ªè®°å¿†æœºåˆ¶å¯ä»¥åº”ç”¨åˆ°ç¤¾ä¼šæ¨¡æ‹Ÿå™¨é¡¹ç›®ä¸­:

### NPCè®°å¿†ç³»ç»Ÿ
```python
class NPCWithMemory:
    def __init__(self, name):
        self.name = name
        self.memory_file = f"memory_{name}.json"
    
    def remember(self, event):
        # ä¿å­˜äº‹ä»¶åˆ°è®°å¿†
        pass
    
    def recall(self):
        # å›å¿†è¿‡å»çš„äº‹ä»¶
        pass
```

### æ™ºèƒ½ä½“è®°å¿†
```python
class AgentWithMemory:
    def __init__(self):
        self.event_history = []
    
    def record_event(self, event):
        # è®°å½•å‘ç”Ÿçš„äº‹ä»¶
        pass
    
    def get_context(self):
        # è·å–å†å²ä¸Šä¸‹æ–‡
        pass
```

---

## âœ… æ€»ç»“

- **app.py**: ç®€å•å¿«é€Ÿ,æ— è®°å¿†
- **app_first.py**: å¼€å§‹å¯¹è¯,ä¿å­˜è®°å¿†
- **app_second.py**: ç»§ç»­å¯¹è¯,ä½¿ç”¨è®°å¿†

ä¸‰ä¸ªæ–‡ä»¶å„æœ‰ç”¨é€”,æ ¹æ®éœ€æ±‚é€‰æ‹©ä½¿ç”¨!

